{% extends 'diary/base.html' %}
{% load static %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-3">Το Προφίλ Μου</h2>

  <!-- Εικόνα προφίλ -->
  <div class="text-center mb-4">
    <form method="post" action="{% url 'upload_profile_image' %}" enctype="multipart/form-data" class="text-center mb-5">
      {% csrf_token %}
      <input type="file" name="profile_image" accept="image/*" required class="form-control mb-2" style="max-width: 300px; margin: 0 auto;">
      <button type="submit" class="btn btn-primary">Αλλαγή Εικόνας Προφίλ</button>
    </form>
    
  </div>

  <!-- Στοιχεία Χρήστη -->
  <div class="card mb-4">
    <div class="card-body">
      <h5 class="card-title">@{{ user.username }}</h5>
      <p class="card-text"><strong>Email:</strong> {{ user.email }}</p>
      <p class="card-text"><strong>Καταχωρήσεις:</strong> {{ total_entries }}</p>
      <p class="card-text"><strong>Ημερήσιες Απαντήσεις:</strong> {{ total_answers }}</p>
      <p class="card-text"><strong>Σειρά Ημερών:</strong> {{ streak }} ημέρες</p>
    </div>
  </div>

  <!-- Badges -->
  <h4 class="mb-2">Τα Badge μου</h4>
  <div class="mb-4">
    {% for badge in badges %}
      <span class="badge bg-success me-2">{{ badge.badge.name }}</span>
    {% empty %}
      <p>Δεν έχεις αποκτήσει ακόμα κάποιο badge.</p>
    {% endfor %}
  </div>

  <!-- Δημόσιες Καταχωρήσεις -->
  <h4 class="mb-2">Δημόσιες Καταχωρήσεις</h4>
  {% if public_entries %}
    <div class="list-group">
      {% for entry in public_entries %}
        <a href="{% url 'entry_view' entry.date %}" class="list-group-item list-group-item-action">
          <strong>{{ entry.date }}</strong> – {{ entry.get_mood_display }} – {{ entry.tag|capfirst }}
        </a>
      {% endfor %}
    </div>
  {% else %}
    <p>Δεν έχεις δημοσιεύσει ακόμα κάποια καταχώρηση.</p>
  {% endif %}
</div>
{% endblock %}
